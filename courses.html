<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ثبت دروس</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm mb-4">
  <div class="container">
    <a class="navbar-brand" href="index.html">مدیریت دروس من</a>
    <div>
      <a class="btn btn-outline-primary mx-1" href="index.html">داشبورد</a>
      <a class="btn btn-outline-primary mx-1" href="terms.html">اطلاعات ترم‌ها</a>
    </div>
  </div>
</nav>

<div class="container">
  <h3 class="mb-4">ثبت درس جدید</h3>

  <form id="courseForm" class="mb-5">
    <div class="row g-3">
      <div class="col-md-4">
        <label for="courseId" class="form-label">شماره درس</label>
        <input type="text" id="courseId" class="form-control" required />
      </div>
      <div class="col-md-4">
        <label for="courseName" class="form-label">نام درس</label>
        <input type="text" id="courseName" class="form-control" required />
      </div>
      <div class="col-md-2">
        <label for="practicalUnits" class="form-label">واحد عملی</label>
        <input type="number" min="0" max="3" step="1" id="practicalUnits" class="form-control" value="0" required />
      </div>
      <div class="col-md-2">
        <label for="theoreticalUnits" class="form-label">واحد تئوری</label>
        <input type="number" min="0" max="3" step="1" id="theoreticalUnits" class="form-control" value="0" required />
      </div>
    </div>

<div class="col-md-4">
  <label for="courseType" class="form-label">نوع درس</label>
  <select id="courseType" class="form-select" required>
    <option value="">انتخاب کنید...</option>
    <option value="عمومی">عمومی</option>
    <option value="پایه">پایه</option>
    <option value="اصلی">اصلی</option>
    <option value="اختیاری">اختیاری</option>
  </select>
</div>

    <div class="row g-3 mt-3">
      <div class="col-md-6">
        <label for="prerequisites" class="form-label">پیش‌نیازها (شماره درس‌ها با کاما جدا)</label>
        <input type="text" id="prerequisites" class="form-control" placeholder="مثلاً 101,102" />
      </div>
      <div class="col-md-6">
        <label for="corequisites" class="form-label">هم‌نیازها (شماره درس‌ها با کاما جدا)</label>
        <input type="text" id="corequisites" class="form-control" placeholder="مثلاً 103" />
      </div>
    </div>

    <div class="mt-4">
      <button type="submit" class="btn btn-primary">ثبت درس</button>
    </div>
  </form>

  <h4>لیست دروس ثبت‌شده</h4>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>شماره درس</th>
        <th>نام درس</th>
        <th>واحد عملی</th>
        <th>واحد تئوری</th>
        <th>واحد کل</th>
        <th>نوع درس</th>
        <th>پیش‌نیازها</th>
        <th>هم‌نیازها</th>
        <th>وضعیت</th>
      </tr>
    </thead>
    <tbody id="coursesTableBody"></tbody>
  </table>
</div>

<footer class="mt-5 mb-3 text-center text-muted">
  ساخته شده توسط محمد
</footer>

<script src="script.js"></script>
<script>
  function renderCourses() {
    const courses = getCourses();
    const tbody = document.getElementById("coursesTableBody");
    tbody.innerHTML = "";

    courses.forEach(c => {
      const tr = document.createElement("tr");

      const statusBadge = c.passed 
        ? `<span class="badge badge-passed">پاس شده</span>` 
        : `<span class="badge badge-failed">پاس نشده</span>`;

      tr.innerHTML = `
        <td>${c.id}</td>
        <td>${c.name}</td>
        <td>${c.practical}</td>
        <td>${c.theoretical}</td>
        <td>${totalUnits(c)}</td>
        <td>${c.type}</td>
        <td>${c.prerequisites.join(", ")}</td>
        <td>${c.corequisites.join(", ")}</td>
        <td>${statusBadge}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  document.getElementById("courseForm").addEventListener("submit", e => {
    e.preventDefault();

    const id = document.getElementById("courseId").value.trim();
    const name = document.getElementById("courseName").value.trim();
    const practical = parseInt(document.getElementById("practicalUnits").value);
    const theoretical = parseInt(document.getElementById("theoreticalUnits").value);
    const type = document.getElementById("courseType").value.trim();
    const prerequisites = document.getElementById("prerequisites").value
      .split(",").map(s => s.trim()).filter(s => s);
    const corequisites = document.getElementById("corequisites").value
      .split(",").map(s => s.trim()).filter(s => s);

    if (id === "" || name === "") {
      alert("شماره درس و نام درس الزامی است.");
      return;
    }

    const courses = getCourses();
    if (courses.some(c => c.id === id)) {
      alert("این شماره درس قبلاً ثبت شده.");
      return;
    }

    courses.push({
      id,
      name,
      practical,
      theoretical,
      type,
      prerequisites,
      corequisites,
      passed: false
    });

    saveCourses(courses);
    renderCourses();

    e.target.reset();
  });

  renderCourses();
</script>
</body>
</html>
